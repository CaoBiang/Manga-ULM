# 阅读器（使用）

## 设计目标

- 提供本地漫画的沉浸式阅读体验。
- 支持翻页、跳页、分栏（宽图切分）、书签与文件信息查看。
- 在不干扰画面的前提下提供可收起的底部工具条。

## 操作说明

- 翻页/工具条：由“点击区域”决定（默认：左侧上一页 / 中间切换进度工具条 / 右侧下一页）。
- 收起进度工具条时，会自动关闭书签、文件信息等展开面板，避免界面残留与遮挡。
- 可视化配置：在阅读器工具条“展开模式”下，点击“点击区域”按钮进入配置界面；也可在“设置” -> “阅读器设置” -> “点击区域”中配置。
- 调整范围：在配置界面拖动两条分割线，即可改变左/中/右区域大小。
- 书签：在工具条中打开“新增书签”，输入备注后回车或点击保存；在“书签列表”中可跳转、编辑备注、删除书签。
- 书签空态：当前文件没有书签时，“书签列表”会显示“暂无书签”提示。
- 文件信息：在工具条中打开“文件信息”，失败时可点击重试。
- 分辨率：在工具条中打开“分辨率”，可在“原图/预设像素（最长边）”之间快速切换；数值越小加载越快，并可能缓解摩尔纹。

## 整体结构

```mermaid
flowchart TD
  "进入阅读器" --> "请求漫画详情与页数"
  "请求漫画详情与页数" --> "加载并渲染当前页图片"
  "加载并渲染当前页图片" --> "底部工具条（可收起）"
  "底部工具条（可收起）" --> "滑块跳页 / 分栏切换 / 分辨率（最长边像素） / 书签（列表/新增/编辑） / 文件信息"
```

## 可配置项

进入“设置” -> “阅读器设置”（`/settings/reader`）可调整：

- 翻页与分栏：默认分栏、宽图判定阈值、翻页时保持工具条状态、点击中部切换工具条。
- 预加载：预加载前后页数、预加载并发数（设备性能较弱建议调低）。
- 页面渲染：页面分辨率（最长边像素）、快捷预设、输出格式/质量/重采样。
- 工具条：动画时长、背景透明度。
- 阅读器控件外观：磨砂模糊、模糊半径、控件背景/边框透明度。
- 点击区域：左/中/右分别执行上一页、下一页、切换/展开/收起进度工具条等，并可拖动分割线调整每个区域宽度。

## 相关实现

- 阅读器入口：`apps/web/src/pages/ReaderView.tsx`（实际实现位于 `apps/web/src/pages/reader/ReaderViewPage.tsx`）
- 组件目录：`apps/web/src/components/reader/*`
- 设置页面：`apps/web/src/pages/settings/SettingsReaderView.tsx`
